<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AcquaTec | Avisos</title>

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="./dashboards.css">
    <!-- 
        href="../assets/icon/favicon.ico"
        <script src="../js/funcoes.js"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    -->
</head>

<!-- <body onload="validarSessao(), atualizarFeed()" style="background-color: #161618;"> -->


        <div class="janela">
            <div class="header-left">
                <h1>Apoena</h1>
    
                <div class="hello">
                    <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
                </div>
    
                <div class="btn-nav-white">
                    <a href="./cards.html">
                        <h3>Seus caminhões</h3>
                    </a>
                </div>
    
                <div class="btn-nav">
    
                    <h3>Relatorio de viagens</h3>
    
                </div>
    
                <div class="btn-nav-white">
                    <a href="./mural.html">
                        <h3>Gerenciar viagens</h3>
                    </a>
                </div>
    
                <div class="btn-logout" onclick="limparSessao()">
                    <h3>Sair</h3>
                </div>
    

        </div>

        <div class="dash-right">

            <div class="avisos">
                <div class="container">
                    <h1>Cadastrar caminhão</h1>
                    <div class="div-form">
                            <label>
                                <h3>Cadastre seu caminhão:</h3>
                                Placa: <input name="titulo" id="in_placa" maxlength="8" type="text" placeholder="AAA-0000" disabled>
                            </label>
                            <br>
                            <label>
                                <h3>Cadastre seu Produto:</h3>
                                Nome: <input name="titulo" id="nome_prod" maxlength="45" type="text" placeholder="Morango, Leite..." disabled>
                                <br>
                                <br>
                                Categoria: <input name="titulo" id="in_categoria" maxlength="45" type="text" placeholder="Fruta, Laticínio..." disabled>
                            </label>
                            <br>
                            <label>
                                <h3>Cadastre a data da viagem:</h3>
                                Data de inicio: <input name="titulo" id="dt_inicio" maxlength="45" type="text" placeholder="2021-11-29" disabled>
                                <br>
                                <br>
                                Data de chegada: <input name="titulo" id="dt_chegada" maxlength="45" type="text"
                                placeholder="2021-11-04" disabled>
                            </label>
                            <br>
                            <br>
                            <div class="div_botoes_cadastro">
                            <button onclick="cadastrar_caminhaotela()">Cadastre seu Caminhão</button>
                            <button onclick="cadastrar_produto()">Cadastre seu Produto</button>
                            <button onclick="cadastrar_viagem()">Comece uma Viagem</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>




            <!-- create table caminhao(
    idcaminhao int primary key auto_increment,
    placa char(8),
    fkempresa int
    ) auto_increment = 100;

    create table produto(
    idproduto int primary key auto_increment,
    nome varchar(45),
    categoria varchar(45),
    tempmax decimal(4,2),
    tempmin decimal(4,2)
    ) auto_increment = 300;
   
    create table viagem (
    idviagem int primary key auto_increment,
    datainicio date,
    datafim date,
    fkproduto int,
    fkcaminhao int
    ) auto_increment = 400; -->

        </div>
    </div>




</body>

</html>

<script>
    // variaves para mudar o disabled das inputs
    var lista_frutas=[]
    var cheque_produto= false;
    var cheque_caminhao= false;
    var cheque_viagem= false;
    function cadastrar_caminhaotela() {
        // cadastrar_caminhao();
        var placa = document.querySelector("#in_placa");
        var produto = document.querySelector("#nome_prod");
        var categoria = document.querySelector("#in_categoria");
        var inicio_viagem = document.querySelector("#dt_inicio");
        var fim_viagem = document.querySelector("#dt_chegada");
        if(cheque_caminhao==false){
        placa.disabled = false;
        produto.disabled = true;
        categoria.disabled = true;
        inicio_viagem.disabled = true;
        fim_viagem.disabled = true;
        cheque_caminhao=true;}
        else if(in_placa.value.length==7 ){
            cadastrar_caminhao();
            alert(`Caminhão ${in_placa.value} cadastrado com sucesso`)
            placa.disabled=true
            cheque_caminhao= false
            placa.value= ''}
            else if(in_placa.value.length< 7 && in_placa.value.length >1 ){
                alert(`a placa precisa ter  7 digitos`)
                cheque_caminhao = false
        }else if(in_placa.value.length >7 ){
            alert(`a placa precisa  ter 7 digitos`)

        }else{
            placa.disabled = true;
            cheque_caminhao=false;
        }
    }
    function cadastrar_produto() {
        var placa = document.querySelector("#in_placa");
        var produto = document.querySelector("#nome_prod");
        var categoria = document.querySelector("#in_categoria");
        var inicio_viagem = document.querySelector("#dt_inicio");
        var fim_viagem = document.querySelector("#dt_chegada");
        placa.disabled = true;
        produto.disabled = false;
        categoria.disabled = false;
        inicio_viagem.disabled = true;
        fim_viagem.disabled = true;
        
        if(cheque_produto== false){
            placa.disabled = true;
            produto.disabled = false;
            categoria.disabled = false;
            inicio_viagem.disabled = true;
            fim_viagem.disabled = true;
             cheque_produto= true;
        }
        else if(nome_prod.value.length>=3 && categoria.value.length>= 3){
            alert(`Voce Cadastrou seu produto com sucesso`)
            produto.disabled = true;
            categoria.disabled = true;
            cheque_produto= false
            nome_prod.value= ``
            in_categoria.value= `` 
        }else if(nome_prod.value.length>=3 && categoria.value.length ==0)
        {
                alert(`informe o nome da categoria`)
        }
        else if(nome_prod.value.length==0 && categoria.value.length >3)
        {
                alert(`informe o nome do prouto`)
        }
        else if(nome_prod.value.length <=2 || categoria.value.length <=2){
            alert(`expecificações dos produtos muitos pequenas`)
        }
        else{
            produto.disabled = true;
            categoria.disabled = true;
            cheque_produto= false;
        }
      
       
    }
    function cadastrar_viagem() {
        var inicio = dt_inicio.value
        var fim = dt_chegada.value
        var placa = document.querySelector("#in_placa");
        var produto = document.querySelector("#nome_prod");
        var categoria = document.querySelector("#in_categoria");
        var inicio_viagem = document.querySelector("#dt_inicio");
        var fim_viagem = document.querySelector("#dt_chegada");

        if(cheque_viagem==false){
        placa.disabled = true;
        produto.disabled = true;
        categoria.disabled = true;
        inicio_viagem.disabled = false;
        fim_viagem.disabled = false;
        cheque_viagem=true;
    }
    else if(inicio.indexOf("/") > -1 || fim.indexOf("/")> -1 ){
    alert(`não insira "/" nas datas utilize traços(-) ` )
    }
    else{
        inicio_viagem.disabled = true;
        fim_viagem.disabled = true;
        cheque_viagem=false;
        
    }
}
function cadastrar_caminhao() {
        // aguardar();

        // var formulario = new URLSearchParams(new FormData(document.getElementById("form_cadastro")));

        
        var fkempresa = sessionStorage.getItem("FKEMPRESA");
        var placa= in_placa.value
      
        fetch("/usuarios/cadastrar_caminhao", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                placa: fkempresa,
                fkempresa:placa,
                
                

            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.alert("Cadastro realizado com sucesso!");
                window.location = "mural.html";
                // finalizarAguardar();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });
    }


</script>